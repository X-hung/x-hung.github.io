<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            深入理解机器码（原码，反码，补码）和算术溢出 | 
        
        陋室Louis Labs
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="X-hung">
    <meta name="description" itemprop="description" content="努力促进中美文化相互交融而非相互排斥。">
    <meta name="keywords" content=",机器码">

    <!-- Site Verification -->
    <meta name="google-site-verification" content="q5A-BPAcJjwDv-2wUfWoDhnN_bTb9CTE9ccYf3sVzVg" />
    

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="陋室Louis Labs">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://www.x-hung.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="深入理解机器码（原码，反码，补码）和算术溢出 | 陋室Louis Labs">
    <meta property="og:image" content="/img/favicon.png" />
    <meta property="og:description" content="努力促进中美文化相互交融而非相互排斥。">
    <meta property="og:article:tag" content="机器码"> 

    
        <meta property="article:published_time" content="8月 19, 2017" />
        <meta property="article:modified_time" content="8月 19, 2017" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="深入理解机器码（原码，反码，补码）和算术溢出 | 陋室Louis Labs">
    <meta name="twitter:description" content="努力促进中美文化相互交融而非相互排斥。">
    <meta name="twitter:image" content="/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://www.x-hung.com" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "陋室Louis Labs",
        "logo": "/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "X-hung",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "来啦？ 这里有给你的一篇文章！"
    },
    "headline": "深入理解机器码（原码，反码，补码）和算术溢出",
    "url": "http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/index.html",
    "datePublished": "8月 19, 2017",
    "dateModified": "8月 19, 2017",
    "description": "努力促进中美文化相互交融而非相互排斥。",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.x-hung.com"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","/css/material.min.css?fJTiM/K1J3dWIruo3pxtAw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","/css/style.min.css?oCSEO3ST+aEypEwttTDI9g==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    
    
    
    
    
    
    .footer-sns-github {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNCA3OGMtNi40IDEuNC0yNi40IDE0LjItMzYgMjIuOC04IDcuMi0yMiAyOS44LTI0LjQgMzkuMi0xLjYgNi40LTIgMTEzLjItMS42IDM2OCAuNiAyOTkuNCAxIDM1OS44IDMuNCAzNjQgMTEgMjAuMiAyMS42IDMyLjQgMzcuMiA0MyAxNS42IDEwLjYgMTcuMiAxMS4yIDM0LjIgMTMuMiAxMC42IDEuMiA2My40IDEuNiAxMjcuNiAxLjRsMTA5LjYtLjYgNi02LjggNi4yLTYuOC0xLjItMjUuMmMtLjgtMTUuOC0uMi0zMy40IDEuNC00Ny4yIDMtMjUuNCAxLjQtMzYuMi02LTQzLjItNS00LjYtNi4yLTQuOC0zMC42LTQuMi0yNy42LjgtMjQgMS42LTY4LjgtMTYtOC42LTMuNC0yMi42LTE4LTI4LjQtMjkuOC0xMS40LTIyLjgtMjctNDUtMzkuMi01NS42LTE0LTEyLjItMTkuOC0yMC44LTE5LjgtMjguNiAwLTExLjYgMTMuNi0xMi42IDMzLjItMi40IDE2LjYgOC44IDIwLjggMTIuNCA0MC44IDM2LjIgMjQuMiAyOC42IDMxIDMzLjYgNTQgMzkuNiAxNS4yIDQgNDIuMiAzIDUxLjQtMS44IDktNC42IDE4LTE1LjIgMjQuNC0yOS4yIDExLjQtMjQuMiA3LjQtMzEuMi0yMC42LTM2LjgtOS44LTItMjkuMi04LTQzLjQtMTMuNC00MC40LTE1LjgtNjQuNi0zNy40LTg1LjQtNzYuMi0xMS42LTIxLjgtMTUuNC0zMy0xOC4yLTUzLjYtNC4yLTMyLjItNC44LTYwLjItMS40LTg0IDMuNC0yMy44IDYuOC0zMi44IDIwLjItNTQgNC02IDguOC0xNS42IDExLTIxLjQgMy44LTEwIDMuOC0xMS42IDEtMzAtNS4yLTM0LjItMy4yLTUyLjQgNy42LTcwLjIgNy4yLTEyLjIgMTUtMTcuMiAyNC4yLTE1LjggMTIuOCAyLjIgNTIgMTcuNCA2Ni44IDI2LjIgMjYgMTUgMjkgMTUuNCA4Mi40IDcuMiAyNC42LTMuOCAzMy44LTQuMiA2MC0zLjIgMTcgLjYgNDEuNCAzIDU0IDUuMiAzOC40IDYuNiA0OS42IDUuMiA3My0xMCA2LjYtNC4yIDE3LjQtOS40IDI0LTExLjYgNi42LTIuMiAxNi01LjggMjEtOC4yIDEzLTYgMjgtNS42IDM1LjYuOCAxMi40IDEwLjQgMTguNiA0MS40IDE0LjQgNzEuNi00LjQgMzAuNi0zIDM5LjQgOC40IDUzLjggMy40IDQuNCAxMS4yIDE5LjIgMTcuNCAzMy4yTDc3NSA0NDN2NzhsLTEwIDI4Yy0xNS4yIDQzLjItMzYuOCA3My4yLTY2LjIgOTIuOC0xMy40IDguOC01NyAyNS40LTc2LjggMjktMjguMiA1LjItMzMuMiAxMi42LTIyIDMyLjIgMTEuMiAxOS40IDEyLjQgMzIuOCAxMS42IDEyOS42bC0uNiA4NS44IDUuNCA0LjZjMy42IDMgOS4yIDUuMiAxNiA2IDUuOC44IDYwLjIgMSAxMjAuNi42IDEwOC40LS42IDExMC4yLS42IDExOS01IDI0LTExLjYgNDAtMjcuNCA1MS42LTUwLjZsNS40LTExIC42LTM0N2MuNC0yMjMtLjItMzUzLjQtMS40LTM2NS0yLTE3LTIuNi0xOC42LTEzLTM0LTEwLjYtMTUuNC0yMi44LTI2LjItNDMuMi0zNy4yLTQuMi0yLjQtNjQuNi0yLjgtMzY2LTMuMi0xOTguNiAwLTM2NCAuNC0zNjcuNiAxLjR6Ii8+PC9zdmc+);
    }
    
    
    
    
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Analytics -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-1-原码、反码和补码的解释"><span class="post-toc-number">1.</span> <span class="post-toc-text">1.1 原码、反码和补码的解释</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-2-整型数的溢出-Overflow"><span class="post-toc-number">2.</span> <span class="post-toc-text">1.2  整型数的溢出(Overflow)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-3-溢出深入分析"><span class="post-toc-number">3.</span> <span class="post-toc-text">1.3  溢出深入分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-3-1-溢出的定义"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1.3.1  溢出的定义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-3-2-溢出的边界"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">1.3.2  溢出的边界</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-3-3-溢出的危害"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">1.3.3  溢出的危害</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-3-4-避免溢出的方法"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">1.3.4  避免溢出的方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-4-二进制数的溢出"><span class="post-toc-number">4.</span> <span class="post-toc-text">1.4 二进制数的溢出</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-1-有符号数才会溢出"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">1.4.1 有符号数才会溢出</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-2-二进制数溢出的判断"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">1.4.2 二进制数溢出的判断</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-3-CPU对溢出的处理方式"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">1.4.3 CPU对溢出的处理方式</span></a></li></ol></li></ol>
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                深入理解机器码（原码，反码，补码）和算术溢出
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>X-hung</strong>
        <span>8月 19, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="https://pan.baidu.com/share/qrcode?w=246&h=246&url=http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/">
    
</ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/机器码/">机器码</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=深入理解机器码（原码，反码，补码）和算术溢出&url=http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=深入理解机器码（原码，反码，补码）和算术溢出&url=http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/index.html&via=X-hung" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://www.x-hung.com/2017/08/19/deep-thinking-in-binary/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>如果你是一个计算机专业的本科生，那么你可能大一时就在《数字逻辑》（或《数字电路》）这本书里面学习了机器码。可能当时学的一头雾水，但是现在回过头去又觉得很Easy，就不以为然了。不幸的是，就是这么简单的知识点，贯穿了整个大学生涯，所以我们要牢记这些知识，以下内容包含在：数字电路，计算机组成原理，汇编语言，操作系统原理等课程中。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-82dbecae0b5753ce.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>x—————————x<br>此处添加《数字逻辑》的笔记，在寝室<br>x—————————x</p>
<blockquote>
<p>友情提示：以下内容部分摘自：<br><em>1.赵岩《C语言点滴》第三章</em><br><em>2.Wikipedia</em><br>侵删</p>
</blockquote>
<h2 id="1-1-原码、反码和补码的解释"><a href="#1-1-原码、反码和补码的解释" class="headerlink" title="1.1 原码、反码和补码的解释"></a>1.1 原码、反码和补码的解释</h2><p>介绍补码之前，先简单介绍一下计算机内部使用的二进制。人类用十进制完全是因为我们有10个手指头。如果有一天你看到一个外星人，它只有4个手指头，那么他使用的一定是四进制，如图1-1所示。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-45255c57d9a6b869.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-1  进制和手指头的关系"></p>
<p>如果能看明白图1-1，说明你已经明白了进制和手指头的关系了。现代的计算机内部使用门电路，它们只能表示0或者1两个状态。如果计算机是一个人，那么他只有两个手指头，所以它使用二进制。所谓的进制，根本就不是什么神秘的东西。</p>
<p>理解了计算机内部使用的二进制，下面来看看原码、反码和补码的官方定义。</p>
<ul>
<li><p><a href="https://www.wikiwand.com/zh-hans/%E5%8E%9F%E7%A0%81" target="_blank" rel="external">原码（<em>True form</em>）</a>：原码是一种计算机中对数字的二进制表示方法，数码序列中最高位为符号位，符号位为0表示正数，符号位为１表示负数；其余有效值部分用二进制的绝对值表示。</p>
</li>
<li><p><a href="https://www.wikiwand.com/zh-hans/%E4%B8%80%E8%A3%9C%E6%95%B8" target="_blank" rel="external">反码（<em>1’s complement，在中国大陆称作反码，港台地区称为一补数</em>）</a>：如果机器数是正数，则该机器数的反码与原码一样；如果机器数是负数，则该机器数的反码是对它的原码（符号位除外）各位取反而得到的。</p>
</li>
<li><p><a href="https://www.wikiwand.com/zh-hans/%E4%BA%8C%E8%A3%9C%E6%95%B8" target="_blank" rel="external">补码（<em>2’s complement，在中国大陆称作补码，港台地区称为二补数</em>）</a>：如果机器数是正数，则该机器数的补码与原码一样；如果机器数是负数，则该机器数的补码是对它的原码（除符号位外）各位取反，并在末位加1。</p>
</li>
</ul>
<blockquote>
<p>补码的反码：按位取反，末位加1。补码系统的最大优点是可以在<a href="https://www.wikiwand.com/zh-hans/%E5%8A%A0%E6%B3%95" target="_blank" rel="external">加法</a>或<a href="https://www.wikiwand.com/zh-hans/%E6%B8%9B%E6%B3%95" target="_blank" rel="external">减法</a>处理中，不需因为数字的正负而使用不同的计算方式。只要一种加法电路就可以处理各种有号数加法，而且减法可以用一个数加上另一个数的二补数来表示，因此只要有加法电路及二补数电路即可完成各种有号数加法及减法，在电路设计上相当方便。（<strong>补码的反码</strong>就是用来处理ALU的减法运算的）</p>
</blockquote>
<p>这样的定义绝对正确，但是绝对也会让你一头雾水，其实我们可以通过画几个图把这些概念简单地阐述清楚。为了方便说明问题，我假定用4位二进制数表示一个整数<a href="http://zhaoyan.website/xinzhi/cbook/c3.php#_ftn1" target="_blank" rel="external">[①]</a>。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-820e081f4d16175a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-2 无符号数的原码.png"></p>
<p>图1-2说明了无符号数的原码表示方法。其中内圈的数字为二进制数，外圈的数字为内圈二进制数所对应的十进制数<a href="http://zhaoyan.website/xinzhi/cbook/c3.php#_ftn2" target="_blank" rel="external">[②]</a>。</p>
<p>顾名思义，无符号数不能表示负数。为了解决这个问题，我们把最高位定义为符号位。如果最高位为1就代表是一个负数，其他三位表示对应的十进制数。如图1-3所示，这就是有符号数的原码表示。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-0c4819d4ea55da7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-3 有符号数的原码表示.png"></p>
<p>但是用原码来表示一个有符号数会带来两个问题。</p>
<ul>
<li>第一个问题就是<strong>正负相加不等于零</strong>。如图1-3所示，1+(−1)，就是0001+1001=1010，按照原码表示等于−2。</li>
<li>第二个问题就是<strong>有两个零存在，分别为0000和1000</strong>。可见，原码不适合用来表示有符号数！</li>
</ul>
<p>为了保证正负相加等于零，我们采用了<strong>反码</strong>的表示方法，反码的表示如图1-4所示。如果把二进制数1000想象成12点，把二进制数0000想象成6点，原码就是从12点开始顺时针排列−1到−7，而反码就是从6点开始逆时针排列−1到−7。这样做的好处就在于现在正负数相加等于零了。例如1+(−1)，就是0001+1110=1111，用反码表示的话就是(−0)了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-88036d163e65f146.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-4 有符号数的反码表示.png"></p>
<p>第一个问题解决了，但是第二个问题还是没有解决，在用反码表示有符号数的图1-4中，依然有两个零存在，分别为0000和1111。聪明的读者一定已经猜到了，<strong>补码</strong>就是为了解决这个问题而发明的。</p>
<p>按照补码的定义，−1的反码为1110，不过现在必须在末位加1，那现在−1就是1111了。以此类推，补码的表示如图1-5。与反码表示不一样的是，补码在负数上从−1表示到−8，−0不再存在了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-d7146b88751a7e5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-5 有符号数的补码表示.png"></p>
<p>虽然第二个问题解决了，但用补码表示时，正负相加还等于零吗？我们可以自己验证一下，如果丢弃最高位的进位，结果满足正负相加等于零。至此，我们找到了终极的解决方案，那就是利用补码来表示一个有符号的整数。注意一点，<strong>对于无符号数，原码、反码、补码都是一致的</strong>。所以我们得到的最后结论是：<strong>整型数在计算机中，使用补码表示。</strong></p>
<h2 id="1-2-整型数的溢出-Overflow"><a href="#1-2-整型数的溢出-Overflow" class="headerlink" title="1.2  整型数的溢出(Overflow)"></a>1.2  整型数的溢出(Overflow)</h2><p>如果1.1节你已经完全明白了，那么下面我们开始讨论在实际编写程序中非常危险的一个bug，那就是C语言的整型数溢出问题。</p>
<p>首先，我们知道，有符号数在计算机内部都是通过补码来表示的。其次，在图1-5中，如果加上x，就代表着顺时针走x格；如果减去x，就代表着逆时针走x格。有了这些知识，让我们用实例说话。在图1-5中，如果3+1，那就是从3顺时针走一格，等于4，没有任何问题。但是如果是7+1呢？顺时针走1格后，变成了−8了。如果7+7呢，顺时针走7格，等于−2了。这就是整型数发生了溢出。</p>
<p>所谓的溢出，就是因为4位二进制数，用补码表示一个整数的时候，所能表示的最大正整数就是2^(4-1)-1=7，如果在7的基础上再加1，就会发生<strong>“轻微溢出”</strong>，变为了最小的那个负数，如果两个最大的正整数相加，就会发生<strong>“严重溢出”</strong>。结果等于−2。这里注意，所谓的“轻微溢出”和“严重溢出”都是从溢出的角度去定义的。事实上，它们都是非常严重的bug，在实际编程中并不是说“严重溢出”就比“轻微溢出”更严重。</p>
<p>那么，C语言中int所表示的“最大正整数”到底是多少呢？不同的平台，不同的编译器，会有不同的定义。为此，C语言在头文件limits.h中给出了相关的宏定义，如表1-1所示。</p>
<p>*表1-1  整型数的极限值宏定义:</p>
<table>
<thead>
<tr>
<th>char</th>
<th>int</th>
<th>short</th>
<th>long</th>
<th>long long</th>
</tr>
</thead>
<tbody>
<tr>
<td>SCHAR_MAX</td>
<td>INT_MAX</td>
<td>SHRT_MAX</td>
<td>LONG_MAX</td>
<td>LLONG_MAX</td>
</tr>
<tr>
<td>SCHAR_MIN</td>
<td>INT_MIN</td>
<td>SHRT_MIN</td>
<td>LONG_MIN</td>
<td>LLONG_MIN</td>
</tr>
<tr>
<td>UCHAR_MAX</td>
<td>UINT_MAX</td>
<td>USHRT_MAX</td>
<td>ULONG_MAX</td>
<td>ULLONG_MAX</td>
</tr>
<tr>
<td>CHAR_MIN</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>CHAR_MAX</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>有了这些宏定义，我们就可以编写出程序1-1，程序中分别演示了加法带来的溢出和减法带来的溢出。</p>
<blockquote>
<p><em>程序1-1  溢出的实例</em><br><img src="http://upload-images.jianshu.io/upload_images/2670080-9fdcbeb13d5fb591.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</blockquote>
<p>程序最后的运行结果如图1-6所示，最大的正整数为2^(32−1)−1=2147483647。其他的数这里不解释了，读者可以按照反码的原理，自己解释并验证一下。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-2ad6e7d784d89ea5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-6  程序运行结果"></p>
<h2 id="1-3-溢出深入分析"><a href="#1-3-溢出深入分析" class="headerlink" title="1.3  溢出深入分析"></a>1.3  溢出深入分析</h2><p>通过1.2节，我们已经初步知道了造成溢出的主要原因，但是只知道原因是不够的。下面我们对溢出的现象进行深入分析。本节主要说明4个子问题：溢出的定义，溢出发生的边界，溢出的危害以及如何避免溢出。</p>
<h3 id="1-3-1-溢出的定义"><a href="#1-3-1-溢出的定义" class="headerlink" title="1.3.1  溢出的定义"></a>1.3.1  溢出的定义</h3><p>关于有符号整型数的溢出，程序1-1已经阐述得很清楚了，大家对这个问题也没有什么异议。但是对于无符号数，《C陷阱与缺陷》 在“整数溢出”一节中指出，在无符号算术运算中，没有所谓的“溢出”一说。我想Koenig的思路可能是这样，当下午1点的时候，没有任何人会说：“现在是12点溢出了。”因为我们已经常识性地知道，我们的钟表上是没有13 这个数字的。但是在C语言中，你能常识性地马上告诉我UINT_MAX是多少吗？下面我们看程序1-2。程序1-2中a是一个无符号整型数，运行这个程序后，会打印出“0”。</p>
<blockquote>
<p><em>程序1-2  无符号整型数溢出的例子</em><br><code>unsigned a = UINT_MAX;</code><br><code>printf (&quot;%u&quot;, a+1);</code></p>
</blockquote>
<p>假设现在你每个月赚UINT_MAX，由于你的工作出色，老板决定下个月给你涨一块钱。根据这段程序，你下个月工资将会是0元。这个时候，如果老板说无符号算术运算中没有“溢出”的话，你会同意吗？所以我决定不再讨论“溢出”是否有符号，而是从工程的角度来看，如果经过程序运算和经过纸和笔运算的结果不一样，那么我们就认为整型数运算发生了溢出。除了运算的溢出，C语言中还有很多其他类型的溢出，读者可以参考本书网站上“扩展内容”网页中的“谈谈C语言的溢出”。</p>
<h3 id="1-3-2-溢出的边界"><a href="#1-3-2-溢出的边界" class="headerlink" title="1.3.2  溢出的边界"></a>1.3.2  溢出的边界</h3><p>图1-7和图1-8分别演示了有符号数和无符号数中的两种溢出，分别为上溢出和下溢出。上溢出是由于顺时针方向旋转（加法）造成的。下溢出是由于逆时针方向旋转（减法）造成的。</p>
<p>对于无符号数，溢出发生的地方在6点钟方向，如图1-7所示。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-093de7205e4bf3d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-7 无符号数的溢出边界.png"></p>
<p>对于有符号数，溢出的边界在12点方向，如图1-8所示。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-121a95a43ad63e51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-8 有符号数的溢出边界.png"></p>
<h3 id="1-3-3-溢出的危害"><a href="#1-3-3-溢出的危害" class="headerlink" title="1.3.3  溢出的危害"></a>1.3.3  溢出的危害</h3><p>溢出最令人沮丧的地方就在于，C语言不通过运行时检查来避免溢出<a href="http://zhaoyan.website/xinzhi/cbook/c3.php#_ftn3" target="_blank" rel="external">[③]</a>，所以程序1-2会正常地运行，没有任何提示和运行错误，你的工资莫名其妙地就变为零了。</p>
<p>当我学习C语言这门课的时候，邻座一美女同学，偷偷递给我一张纸条，纸条上写着程序1-3。我看了一眼对她说：“你没有考虑溢出啊！如果love溢出，会变成一个最小的负数。”然后我就把这个字条还给了那位美女同学。从此以后，她就再也没有联系过我。直到现在，我依然后悔，后悔只是关注了love的溢出，而没有关注time的溢出。</p>
<blockquote>
<p><em>程序1-3  程序员的求爱信</em><br><code>while (time++) { love++; }</code></p>
</blockquote>
<p>溢出的危害如此严重，它能让你从亿万富翁一下变为穷光蛋，也能让你错失到手的爱情，还有什么比这更严重的呢？那为什么C语言不去避免这种错误呢？这符合C语言的两个风格：信任程序员，只要快。因为C语言信任你，所以编译器认为你写出UINT_MAX+1是对的，就算你把铅笔插到自己的鼻孔里，编译器也是认为你是对的，没有运行时检查是为了保证速度。假如你出门旅游的时候带着妈妈，我敢说这一路你是安全的，但是你一定快不起来。C语言就是这样，把妈妈放到家里，把铅笔插到鼻孔里，走你！</p>
<h3 id="1-3-4-避免溢出的方法"><a href="#1-3-4-避免溢出的方法" class="headerlink" title="1.3.4  避免溢出的方法"></a>1.3.4  避免溢出的方法</h3><p>聪明的读者一定都看出来了，上面关于美女和纸条的故事是杜撰的。实际的情况是我根本就没上过C语言的课，完全是自学成才。学成后写了一个十万行的程序，送给我暗恋的女孩，她看后十分感动，然后拒绝了我。实际编写工程的时候，溢出发生的概率和美女给你递纸条的概率一样，都不是很高，所以你也不用过分担心这个问题。避免溢出的一个最根本原则就是了解你要处理问题的规模，如果要处理一个班的学生，你完全可以忽略溢出问题；但是如果要处理全世界的人口，那么你就应该提高警惕了。</p>
<p>一个比较简单的避免溢出的方法就是利用double数据类型。一般情况下，让double溢出还真是件比较困难的事。如果要求一定要用整型数来完成任务，那么你首先应该利用表3-1中的宏定义，了解一下C语言在你所用平台上的极限值，并且利用这些宏定义和程序3-4中列出的判断表达式来避免溢出的发生。请注意，程序3-4中的判断表达式有的时候代表溢出会发生，有的时候代表溢出已经发生。</p>
<blockquote>
<p><em>程序3-4  避免溢出的技巧</em><br><img src="http://upload-images.jianshu.io/upload_images/2670080-733096b1391462b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
</blockquote>
<p>现在让我们轻松一下吧。设想一下如果一个程序员生了四个女儿，你如何给她们起名字呢？大女儿就叫“玲玲”吧，二女儿叫“玲依”，三女儿叫“依玲”，那么四女儿呢？你一定猜到了，按照这个顺序，就应该叫“依依”了。没错了，在软件学院我的学生里面，就有一个叫“张依依”的女生，不知道她是不是她爸爸的第四个女儿。让我们继续下去，如果这个程序员生下了第五个女儿，那么应该叫什么呢？按照上面介绍过的内容，她应该叫“忆初”了！希望你们能通过这些美丽的女孩名字记住上面讲到的内容，并衷心祝愿这个程序员早日生一个男孩。</p>
<h2 id="1-4-二进制数的溢出"><a href="#1-4-二进制数的溢出" class="headerlink" title="1.4 二进制数的溢出"></a>1.4 二进制数的溢出</h2><h3 id="1-4-1-有符号数才会溢出"><a href="#1-4-1-有符号数才会溢出" class="headerlink" title="1.4.1 有符号数才会溢出"></a>1.4.1 有符号数才会溢出</h3><p>二进制数的溢出一般出现在ALU的加法运算中，溢出仅针对有符号数的运算，一般有两种情况：</p>
<ul>
<li>两个正数相加，结果为负数；</li>
<li>两个负数相加，结果为正数。</li>
</ul>
<p>如图1-9所示，0011 加上0101如果用个四位加法器进行运算， 就会得到1000.如果我们把它们都看成无符号数那么0011就是3，0101就是5； 而1000就是8 。那么这个运算结果是正确的。 但如果我们把它看作有符号数 原操作数仍然是3和5单一运算结果1000他其实代表的是-8（参见图1-8）。 这个结果是不正确的，也就是发生了溢出。 </p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-e864e288c237e5c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-9"></p>
<p>需要注意的是，“进位”和“溢出”的关系是：</p>
<ul>
<li>有“溢出”时，不一定有“进位”；</li>
<li>有“进位”时，不一定有“溢出”。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-d82bb42c03c0ad1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-10"></p>
<p>x—————————x<br>这段话太罗嗦，重新修改<br>x—————————x<br>如图1-10，1110加上1100送到 四位的加法器中运算的结果1010 ，同时有一个进位1。 这显然是有进位 但它却是无溢出的情况。为什么呢？我们来看，如果把它当作无符号数进行运算 1110是14，1100是12 如果带上进位一起考虑那就是正确的运算结果26。 如果不带进位则是为10 。因为四位的二进制位只能表示小于16的数， 所以<strong>无符号数的的运算结果可以默认为对结果进行 模16的运算</strong>。那只看着四位的话结果是10，相当于26 模16的值。 所以这也是正确的。而对于有符号数来说相当于-2加上-4 而这四位的结果就是-6 ，这个运算也是正确的。 当然，从另一个角度来看因为溢出是针对有符号的数目的运算结果，超出了能表示的 范围，我们也可以把有进位这种情况看作无符号数的运算超出了能够表示的范围。</p>
<h3 id="1-4-2-二进制数溢出的判断"><a href="#1-4-2-二进制数溢出的判断" class="headerlink" title="1.4.2 二进制数溢出的判断"></a>1.4.2 二进制数溢出的判断</h3><p>在ALU中，进位是很容易判断的，加法器本身就提供了这样的机制。 最高位的全加器的进位输出就是整个加法器的进位。那么溢出又该如何判断呢？其实很简单，利用全加器就能判断，即：<strong>“最高位的进位输入”不等于“最高位的进位输出”</strong>。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-abd90fd0de365a27.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-11"></p>
<p>就是最高位全加器的进位输出。 把这两个信号连出来，判断它们是否不相等。那么用什么 方法来判断不相等呢？其实非常简单，就连接一个异或门就可以了。 当它们不相等时，异或门的输出为1 当他们两个都为0或者都为1时，异或门的输出为0 因此，就可以用这个信号来表示是否发生了溢出。 至于为什么用这个方法就可以判断溢出，留给大家自己思考。</p>
<h3 id="1-4-3-CPU对溢出的处理方式"><a href="#1-4-3-CPU对溢出的处理方式" class="headerlink" title="1.4.3 CPU对溢出的处理方式"></a>1.4.3 CPU对溢出的处理方式</h3><p> 不同体系结构有不同的方法。我们先来开MIPS处理溢出的方式。 </p>
<p>（1）将操作数看做有符号数，发生“溢出”时产生异常</p>
<ul>
<li>add rd,rs,rt   # R[rd]=R[rs]+R[rt]</li>
<li>addi rt,rs,imm # R[rt]=R[rs]+SignExtImm</li>
</ul>
<p>（2）将操作数看做无符号数，不处理“溢出”</p>
<ul>
<li>addu rd,rs,rt # R[rd]=R[rs]+R[rt]</li>
<li>addiu rt,rs,imm # R[rt]=R[rs]+SignExtImm</li>
</ul>
<p>它提供了两种不同的指令。如果编程人员想将操作数看作有符号数，需要处理溢出， 则需要使用add和addi这样的指令。 当这样的运算发生溢出时，会产生异常。 就是说，控制电路会检查加法器产生的overflow的信号。 如果overflow信号有效，控制电路就会当做一个异常的情况进行处理。 至于如何处理，我们会在讲到中断和异常时再做分析。 如果编程人员希望将操作数看作无符号数，也就是不对溢出进行处理。 那就需要使用这两条指令，addu和addiu。它们分别和上面这两条指令是对应的。 唯一的区别就是，在执行这两条指令时，控制电路不会检查加法器输出的overflo- w信号。 所以说，MIPS处理溢出的方式是提前做准备。 按照是否要处理溢出，采用不同的指令进行运算。 </p>
<p>而x86则采用了另一种方式。它并没有根据是否处理溢出分为两种 运算指令，x86的运算指令，如果产生了溢出， 并不会直接由控制电路检查到并进行处理。 而是将加法器产生的溢出信号传送到了标志寄存器。 如果发生溢出，则会致标志寄存器当中的OF位为1. 如果没有发生溢出，则致OF位为0. 这就是x86的标志寄存器，其中第十一位是 OF位，这就是溢出标志。 则在后续的指令中，需要检查标志寄存器的OF位是否为1并进行相应的操作。</p>
<p>溢出标志OF（Overflow Flag）</p>
<ul>
<li>如果把操作数看做有符号数，运算结果是否发生溢出</li>
<li>若发生溢出，则自动设置OF=1；否则，OF=0</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2670080-e63e69ac842d79cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1-12"></p>
<blockquote>
<p><strong>延伸阅读</strong><br><em>1.《C语言点滴》，赵岩，人民邮电出版社；<br>2.《汇编语言》，第三版，王爽，清华大学出版社；<br>3.《深入理解计算机系统》（Computer Systems: A Programmer’s Perspective），第三版，[美]Randal E.Bryant / David O’Hallaron，机械工业出版社；</em></p>
</blockquote>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/08/25/第一讲、互联网发展和体系结构的启示/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/08/19/search-these-before-learning/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="X-hung's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        唯音乐与爱不可辜负。
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mail to: x.hung.chn@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">11</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/C语言学习笔记/">C语言学习笔记<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/书房/">书房<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/小白专区/">小白专区<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/组原笔记/">组原笔记<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/计算机网络笔记/">计算机网络笔记<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/随笔/">随笔<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">11</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

    <a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
             sidebar.about_theme
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
    </a>

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://www.github.com/x-hung" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2016&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>陋室Louis Labs
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
                <div class="footer-develop-div">本网站由 <a href="https://www.aliyun.com/" target="_blank" class="footer-develop-a">阿里云</a> 提供服务</div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==")</script>
    <script>lsloader.load("js/js.min.js","/js/js.min.js?oAl/+lvaqTFV31JXTmbrNA==")</script>



    <script>lsloader.load("js/nprogress.js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("js/smoothscroll.js","/js/smoothscroll.js?lOy/ACj5suSNi7ZVFVbpFQ==")</script>
    











<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
